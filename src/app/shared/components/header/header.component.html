<nav class="navbar navbar-expand-lg navbar-dark bg-purple shadow-sm">
  <div class="container-fluid">
    <a class="navbar-brand fw-bold" routerLink="/">
      <i class="fas fa-gift me-2"></i> Wombo Perú
    </a>

    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div class="collapse navbar-collapse" id="navbarNav">
      <ul class="navbar-nav me-auto mb-2 mb-lg-0">
        <li class="nav-item">
          <a class="nav-link" routerLink="/products" routerLinkActive="active">
            <i class="fas fa-store me-1"></i> Catálogo
          </a>
        </li>
      </ul>

      <!-- Usuario autenticado -->
      <ng-container *ngIf="currentUser$ | async as user; else notLoggedIn">
        <div class="navbar-nav">
          <div class="nav-item dropdown">
            <a
              class="nav-link dropdown-toggle"
              href="#"
              id="navbarDropdown"
              role="button"
              data-bs-toggle="dropdown"
              aria-expanded="false"
            >
              <i class="fas fa-user-circle me-1"></i> Hola, {{ user.nombre }}
            </a>

            <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="navbarDropdown">
              <li><a class="dropdown-item" routerLink="/profile"><i class="fas fa-id-badge me-2"></i>Mi Perfil</a></li>
              <li><a class="dropdown-item" routerLink="/my-orders"><i class="fas fa-box me-2"></i>Mis Pedidos</a></li>
              <li><a class="dropdown-item" routerLink="/cart"><i class="fas fa-shopping-cart me-2"></i>Mi Carrito</a></li>
              <li><a class="dropdown-item" routerLink="/password-recovery"><i class="fas fa-key me-2"></i>¿Olvidaste tu contraseña?</a></li>

              <ng-container *ngIf="user.roles.includes('ROLE_ADMIN') || user.roles.includes('ROLE_WORKER')">
                <li><hr class="dropdown-divider"></li>
                <li>
                  <a class="dropdown-item" [routerLink]="user.roles.includes('ROLE_ADMIN') ? '/admin' : '/worker'">
                    <i class="fas fa-tools me-2"></i> Panel de Gestión
                  </a>
                </li>
              </ng-container>

              <li><hr class="dropdown-divider"></li>
              <li><a class="dropdown-item logout-link" (click)="logout()"><i class="fas fa-sign-out-alt me-2"></i>Cerrar Sesión</a></li>
            </ul>
          </div>
        </div>
      </ng-container>

      <!-- Usuario no logueado -->
      <ng-template #notLoggedIn>
        <div class="navbar-nav">
          <a routerLink="/login" class="btn btn-outline-light me-2">
            <i class="fas fa-sign-in-alt me-1"></i> Iniciar Sesión
          </a>
          <a routerLink="/register" class="btn btn-warning">
            <i class="fas fa-user-plus me-1"></i> Registrarse
          </a>
        </div>
      </ng-template>
    </div>
  </div>
</nav>